import{B as U,r as f,o as a,a as l,h as z,l as K,b as t,t as d,f as _,D as O,u as b,w as C,S as w,E as P,p as j,c as x,F as D,d as I,j as S,k as N,m as E}from"./index-1b31af87.js";import{S as L,_ as R}from"./sku-generator-b3e0ecb4.js";import{n as q}from"./no-image-7601bee4.js";const B={Red:"Красный",Blue:"Синий",Green:"Зелёный",Yellow:"Жёлтый",Purple:"Фиолетовый",Pink:"Розовый",black:"Чёрный",white:"Белый"};function F(c){const e=Object.keys(B).find(o=>o.toUpperCase().trim()===c.toUpperCase().trim());return e?B[e]:c}const M={class:"cart__item product"},A=["src","alt"],G={class:"product__content"},Q={class:"product__info-wrap"},Y={class:"product__title"},H={class:"product__info product__info--color"},J={class:"product__size"},W={class:"product__code"},X={class:"product__counter form__counter"},Z={key:0,size:"16 16",symbol:"icon-delete"},tt={key:1,size:"12 12",symbol:"icon-minus"},et=["value"],st={size:"12 12",symbol:"icon-plus"},ot={class:"product__price"},nt={__name:"CartItem",props:["item"],emits:["update:cart","confirm:delete"],setup(c,{emit:e}){const o=c,u=300,k=U(),m=f(o.item.product),r=f(o.item.quantity),i=f(new L({id:m.value.id,color:o.item.color.color.id,size:o.item.size.id}).toString());let n;function p(){r.value++,g()}function y(){if(r.value>1)r.value--;else{g(!0);return}g()}function g(v=!1){clearTimeout(n),n=setTimeout(()=>{const s=k.getUser();v?w.deleteBasketProduct(o.item.id,s==null?void 0:s.accessKey).then(h=>{e("update:cart",h)}):w.changeBasketQuantity(o.item.id,r.value,s==null?void 0:s.accessKey).then(h=>{e("update:cart",h)})},u)}function T(v){var s;return v?(s=v[0])==null?void 0:s.file.url:q}return(v,s)=>{const h=P("RouterLink"),$=j("svg");return a(),l("li",M,[z(h,{class:"product__pic",to:{name:"product",params:{id:c.item.product.id}}},{default:K(()=>[t("img",{src:T(c.item.color.gallery),width:"120",height:"120",alt:c.item.title},null,8,A)]),_:1},8,["to"]),t("div",G,[t("div",Q,[t("h3",Y,d(m.value.title),1),t("p",H,[_(" Цвет: "),t("span",null,[t("i",{style:O(`background-color: ${c.item.color.color.code}`)},null,4),_(" "+d(b(F)(c.item.color.color.title)),1)])]),t("p",J,[_(" Размер: "),t("span",null,d(c.item.size.title),1)]),t("span",W," Артикул: "+d(i.value),1)]),t("div",X,[t("button",{type:"button","aria-label":"Убрать один товар",onClick:s[0]||(s[0]=V=>y())},[r.value===1?C((a(),l("svg",Z,null,512)),[[$]]):C((a(),l("svg",tt,null,512)),[[$]])]),t("input",{type:"text",value:r.value,name:"count"},null,8,et),t("button",{type:"button","aria-label":"Добавить один товар",onClick:s[1]||(s[1]=V=>p())},[C((a(),l("svg",st,null,512)),[[$]])])])]),t("div",ot,d(m.value.price*r.value)+"₽",1)])}}},ct={class:"content container"},it={class:"content__top"},rt={class:"cart"},at={key:0,class:"cart__form form",action:"#",method:"POST"},lt={class:"cart__field"},ut={class:"cart__list"},dt={class:"cart__block"},_t=t("p",{class:"cart__desc"},"Мы посчитаем стоимость доставки на следующем этапе",-1),mt={class:"cart__price"},pt={key:1},vt=t("h2",null,"Ой, пусто!",-1),ht=t("p",null,[_(" Ваша корзина пуста, откройте каталог "),t("br"),_("и выбирайте лучшие товары с бесплатной доставкой ")],-1),ft=t("br",null,null,-1),gt={__name:"CartView",setup(c){const e=U(),o=f(!1),u=e.getUser();u!=null&&u.accessKey&&(o.value=!0,w.getBasket(u.accessKey).then(i=>{Object.assign(e.cart,i),e.setUser(e.cart.user),o.value=!1}));const k=x(()=>e.cart.items.reduce((i,n)=>i+=n.price*n.quantity,0)),m=f([{title:"Каталог",route:{name:"main"}},{title:"Корзина",route:{path:"#"}}]);function r(i){Object.assign(e.cart,i)}return(i,n)=>(a(),l("main",ct,[t("div",it,[z(R,{links:m.value},null,8,["links"])]),t("section",rt,[!o.value&&b(e).count>0?(a(),l("form",at,[t("div",lt,[t("ul",ut,[(a(!0),l(D,null,I(b(e).cart.items,p=>(a(),E(nt,{key:p.id,item:p,"onUpdate:cart":n[0]||(n[0]=y=>r(y))},null,8,["item"]))),128))])]),t("div",dt,[_t,t("p",mt,[_(" Итого: "),t("span",null,d(b(k))+" ₽",1)]),t("button",{class:"cart__button button button--primery",type:"submit",onClick:n[1]||(n[1]=S(()=>i.$router.push({name:"checkout"}),["prevent"]))}," Оформить заказ ")])])):o.value?N("",!0):(a(),l("div",pt,[vt,ht,ft,t("button",{class:"item__button button button--primery",onClick:n[2]||(n[2]=S(p=>i.$router.push({name:"products"}),["prevent"]))}," Начать покупки ")]))])]))}};export{gt as default};
