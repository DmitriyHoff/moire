import{B as S,r as f,o as l,a as r,h as T,l as V,b as t,t as _,f as m,D,u as k,w as $,S as C,E as K,p as O,G as P,c as U,F as j,d as x,j as w,k as L,m as N}from"./index-996ad4b8.js";import{S as R,_ as I}from"./sku-generator-6127eb69.js";const B={Red:"Красный",Blue:"Синий",Green:"Зелёный",Yellow:"Жёлтый",Purple:"Фиолетовый",Pink:"Розовый",black:"Чёрный",white:"Белый"};function q(s){const o=Object.keys(B).find(e=>e.toUpperCase().trim()===s.toUpperCase().trim());return o?B[o]:s}const F={class:"cart__item product"},G=["src","alt"],M={class:"product__content"},A={class:"product__info-wrap"},Q={class:"product__title"},Y={class:"product__info product__info--color"},H={class:"product__size"},J={class:"product__code"},W={class:"product__counter form__counter"},X={key:0,size:"16 16",symbol:"icon-delete"},Z={key:1,size:"12 12",symbol:"icon-minus"},tt=["value"],et={size:"12 12",symbol:"icon-plus"},st={class:"product__price"},ot={__name:"CartItem",props:["item"],emits:["update:cart","confirm:delete"],setup(s,{emit:o}){const e=s,p=300,u=S(),v=f(e.item.product),a=f(e.item.quantity),y=f(new R({id:v.value.id,color:e.item.color.color.id,size:e.item.size.id}).toString());console.log("product",e.item);let h;function c(){a.value++,d()}function n(){if(a.value>1)a.value--;else{d(!0);return}d()}function d(b=!1){clearTimeout(h),h=setTimeout(()=>{b?C.deleteBasketProduct(e.item.id,u.user.accessKey).then(i=>{console.log("DELETE",i),o("update:cart",i)}):C.changeBasketQuantity(e.item.id,a.value,u.user.accessKey).then(i=>{console.log(i),o("update:cart",i)})},p)}return(b,i)=>{const z=K("RouterLink"),g=O("svg");return l(),r("li",F,[T(z,{class:"product__pic",to:{name:"product",params:{id:s.item.product.id}}},{default:V(()=>[t("img",{src:s.item.color.gallery[0].file.url,width:"120",height:"120",alt:s.item.title},null,8,G)]),_:1},8,["to"]),t("div",M,[t("div",A,[t("h3",Q,_(v.value.title),1),t("p",Y,[m(" Цвет: "),t("span",null,[t("i",{style:D(`background-color: ${s.item.color.color.code}`)},null,4),m(" "+_(k(q)(s.item.color.color.title)),1)])]),t("p",H,[m(" Размер: "),t("span",null,_(s.item.size.title),1)]),t("span",J," Артикул: "+_(y.value),1)]),t("div",W,[t("button",{type:"button","aria-label":"Убрать один товар",onClick:i[0]||(i[0]=E=>n())},[a.value===1?$((l(),r("svg",X,null,512)),[[g]]):$((l(),r("svg",Z,null,512)),[[g]])]),t("input",{type:"text",value:a.value,name:"count"},null,8,tt),t("button",{type:"button","aria-label":"Добавить один товар",onClick:i[1]||(i[1]=E=>c())},[$((l(),r("svg",et,null,512)),[[g]])])])]),t("div",st,_(v.value.price*a.value)+"₽",1)])}}},nt={class:"content container"},ct={class:"content__top"},it={class:"cart"},at={key:0,class:"cart__form form",action:"#",method:"POST"},lt={class:"cart__field"},rt={class:"cart__list"},ut={class:"cart__block"},dt=t("p",{class:"cart__desc"},"Мы посчитаем стоимость доставки на следующем этапе",-1),_t={class:"cart__price"},mt={key:1},pt=t("h2",null,"Ой, пусто!",-1),vt=t("p",null,[m(" Ваша корзина пуста, откройте каталог "),t("br"),m("и выбирайте лучшие товары с бесплатной доставкой ")],-1),ht=t("br",null,null,-1),kt={__name:"CartView",setup(s){var h;const o=S(),{user:e,cart:p}=P(o);console.log("cart:",p.value);const u=f(!1);(h=e.value)!=null&&h.accessKey&&(u.value=!0,C.getBasket(e.value.accessKey).then(c=>{Object.assign(p,c),o.user=e,u.value=!1}));const v=U(()=>p.value.items.reduce((c,n)=>c+=n.price*n.quantity,0)),a=f([{title:"Каталог",route:{name:"main"}},{title:"Корзина",route:{path:"#"}}]);function y(c){Object.assign(o.cart,c)}return(c,n)=>(l(),r("main",nt,[t("div",ct,[T(I,{links:a.value},null,8,["links"])]),t("section",it,[!u.value&&k(o).count>0?(l(),r("form",at,[t("div",lt,[t("ul",rt,[(l(!0),r(j,null,x(k(o).cart.items,d=>(l(),N(ot,{key:d.id,item:d,"onUpdate:cart":n[0]||(n[0]=b=>y(b))},null,8,["item"]))),128))])]),t("div",ut,[dt,t("p",_t,[m(" Итого: "),t("span",null,_(k(v))+" ₽",1)]),t("button",{class:"cart__button button button--primery",type:"submit",onClick:n[1]||(n[1]=w(()=>c.$router.push({name:"checkout"}),["prevent"]))}," Оформить заказ ")])])):u.value?L("",!0):(l(),r("div",mt,[pt,vt,ht,t("button",{class:"item__button button button--primery",onClick:n[2]||(n[2]=w(d=>c.$router.push({name:"products"}),["prevent"]))}," Начать покупки ")]))])]))}};export{kt as default};
