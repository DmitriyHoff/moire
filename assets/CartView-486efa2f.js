import{m as S,r as h,o as r,a as l,j as z,p as T,b as t,t as _,f as m,E as V,u as b,w as C,S as w,G as I,x as K,c as O,F as R,d as j,k as B,l as x,y as D}from"./index-b566bbf8.js";import{t as E}from"./sku-generator-acc5bf01.js";import{t as L}from"./color-dictionary-be2850f0.js";import{n as P}from"./no-image-7601bee4.js";import{_ as q}from"./BreadcrumbTrail-60c749f9.js";const F={class:"cart__item product"},M=["src","alt"],A={class:"product__content"},G={class:"product__info-wrap"},Q={class:"product__title"},H={class:"product__info product__info--color"},J={class:"product__size"},W={class:"product__code"},X={class:"product__counter form__counter"},Y={class:"product__counter-wrap"},Z={key:0,size:"16 16",symbol:"icon-delete"},tt={key:1,size:"12 12",symbol:"icon-minus"},et=["value"],st={size:"12 12",symbol:"icon-plus"},ot={class:"product__price"},nt={__name:"CartItem",props:["item"],emits:["update:cart","confirm:delete"],setup(a,{emit:o}){const n=a,u=300,k=S(),p=h(n.item.product),i=h(n.item.quantity),c=h(E({id:p.value.id,color:n.item.color.color.id,size:n.item.size.id}));let s;function v(){i.value++,$()}function y(){if(i.value>1)i.value--;else{$(!0);return}$()}function $(d=!1){clearTimeout(s),s=setTimeout(()=>{const e=k.getUser();d?w.deleteBasketProduct(n.item.id,e==null?void 0:e.accessKey).then(f=>{o("update:cart",f)}):w.changeBasketQuantity(n.item.id,i.value,e==null?void 0:e.accessKey).then(f=>{o("update:cart",f)})},u)}function U(d){var e;return d?(e=d[0])==null?void 0:e.file.url:P}return(d,e)=>{const f=I("RouterLink"),g=K("svg");return r(),l("li",F,[z(f,{class:"product__pic",to:{name:"product",params:{id:a.item.product.id}}},{default:T(()=>[t("img",{src:U(a.item.color.gallery),width:"120",height:"120",alt:a.item.title},null,8,M)]),_:1},8,["to"]),t("div",A,[t("div",G,[t("h3",Q,_(p.value.title),1),t("p",H,[m(" Цвет: "),t("span",null,[t("i",{style:V(`background-color: ${a.item.color.color.code}`)},null,4),m(" "+_(b(L)(a.item.color.color.title)),1)])]),t("p",J,[m(" Размер: "),t("span",null,_(a.item.size.title),1)]),t("span",W," Артикул: "+_(c.value),1)]),t("div",X,[t("div",Y,[t("button",{type:"button","aria-label":"Убрать один товар",onClick:e[0]||(e[0]=N=>y())},[i.value===1?C((r(),l("svg",Z,null,512)),[[g]]):C((r(),l("svg",tt,null,512)),[[g]])]),t("input",{type:"text",value:i.value,name:"count"},null,8,et),t("button",{type:"button","aria-label":"Добавить один товар",onClick:e[1]||(e[1]=N=>v())},[C((r(),l("svg",st,null,512)),[[g]])])]),t("div",ot,_(d.$format.currRUB(p.value.price*i.value)),1)])])])}}},ct={class:"content container"},it={class:"content__top"},rt={class:"cart"},at={key:0,class:"cart__form form",action:"#",method:"POST"},lt={class:"cart__field"},ut={class:"cart__list"},dt={class:"cart__block"},_t=t("p",{class:"cart__desc"},"Мы посчитаем стоимость доставки на следующем этапе",-1),mt={class:"cart__price"},pt={key:1},vt=t("h2",null,"Ой, пусто!",-1),ft=t("p",null,[m(" Ваша корзина пуста, откройте каталог "),t("br"),m("и выбирайте лучшие товары с бесплатной доставкой ")],-1),ht=t("br",null,null,-1),Ct={__name:"CartView",setup(a){const o=S(),n=h(!1),u=o.getUser();u!=null&&u.accessKey&&(n.value=!0,w.getBasket(u.accessKey).then(c=>{Object.assign(o.cart,c),o.setUser(o.cart.user),n.value=!1}));const k=O(()=>o.cart.items.reduce((c,s)=>c+=s.price*s.quantity,0)),p=h([{title:"Каталог",route:{name:"main"}},{title:"Корзина",route:{path:"#"}}]);function i(c){Object.assign(o.cart,c)}return(c,s)=>(r(),l("main",ct,[t("div",it,[z(q,{links:p.value},null,8,["links"])]),t("section",rt,[!n.value&&b(o).count>0?(r(),l("form",at,[t("div",lt,[t("ul",ut,[(r(!0),l(R,null,j(b(o).cart.items,v=>(r(),D(nt,{key:v.id,item:v,"onUpdate:cart":s[0]||(s[0]=y=>i(y))},null,8,["item"]))),128))])]),t("div",dt,[_t,t("p",mt,[m(" Итого: "),t("span",null,_(c.$format.currRUB(b(k))),1)]),t("button",{class:"cart__button button button--primery",type:"submit",onClick:s[1]||(s[1]=B(()=>c.$router.push({name:"checkout"}),["prevent"]))}," Оформить заказ ")])])):n.value?x("",!0):(r(),l("div",pt,[vt,ft,ht,t("button",{class:"item__button button button--primery",onClick:s[2]||(s[2]=B(v=>c.$router.push({name:"products"}),["prevent"]))}," Начать покупки ")]))])]))}};export{Ct as default};
