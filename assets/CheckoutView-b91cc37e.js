import{S as x,_ as z}from"./sku-generator-89390606.js";import{r as y,c as g,S as $,o as a,a as n,F as f,d as T,b as e,w as p,C as I,u as m,i as C,f as b,t as d,k as V,x as w,B as A,q as U,A as v,h as k,j as B,p as S}from"./index-9e1c7b37.js";const D=e("h3",{class:"cart__title"},"Доставка",-1),R={key:0,class:"cart__options options"},E={class:"options__label"},L=["value"],M={class:"options__value"},N={key:0},P={__name:"CheckoutDelivery",props:["modelValue"],emits:["update:modelValue"],setup(h,{emit:r}){const c=h,s=y(!1);s.value=!0;const u=y({}),_=g({get(){return c.modelValue},set(l){r("update:modelValue",l)}});return $.getDeliveries().then(l=>{u.value=l,s.value=!1}),(l,o)=>(a(),n(f,null,[D,s.value?V("",!0):(a(),n("ul",R,[(a(!0),n(f,null,T(u.value,i=>(a(),n("li",{class:"options__item",key:i.id},[e("label",E,[p(e("input",{class:"options__radio sr-only",type:"radio",name:"delivery",value:i.id,"onUpdate:modelValue":o[0]||(o[0]=t=>C(_)?_.value=t:null)},null,8,L),[[I,m(_)]]),e("span",M,[b(d(i.title)+" ",1),i.price>0?(a(),n("strong",N,d(l.$format.currRUB(i.price)),1)):V("",!0)])])]))),128))]))],64))}},q=e("h3",{class:"cart__title"},"Оплата",-1),F={class:"cart__options options"},O={class:"options__label"},K=["value"],j={class:"options__value"},Z={__name:"CheckoutPayment",props:["modelValue","deliveryTypeId"],emits:["update:modelValue"],setup(h,{emit:r}){const c=h,s=y({});w(()=>c.deliveryTypeId,()=>{console.log(c.deliveryTypeId),$.getPayments(c.deliveryTypeId).then(_=>{console.log("pay",_),s.value=_})});const u=g({get(){return c.modelValue},set(_){r("update:modelValue",_)}});return(_,l)=>(a(),n(f,null,[q,e("ul",F,[(a(!0),n(f,null,T(s.value,o=>(a(),n("li",{key:o.id,class:"options__item"},[e("label",O,[p(e("input",{class:"options__radio sr-only",type:"radio",name:"pay",value:o.id,"onUpdate:modelValue":l[0]||(l[0]=i=>C(u)?u.value=i:null)},null,8,K),[[I,m(u)]]),e("span",j,d(o.title),1)])]))),128))])],64))}},G={class:"cart__form form",action:"#",method:"POST"},H={class:"cart__field"},J={class:"cart__data"},Q={class:"form__label"},W=e("span",{class:"form__value"},"ФИО",-1),X={class:"form__label"},Y=e("span",{class:"form__value"},"Адрес доставки",-1),ee={class:"form__label"},te=e("span",{class:"form__value"},"Телефон",-1),se=e("span",{class:"form__error"},"Неверный формат телефона",-1),oe={class:"form__label"},le=e("span",{class:"form__value"},"Email",-1),ae={class:"form__label"},ne=e("span",{class:"form__value"},"Комментарий к заказу",-1),re={class:"cart__options"},_e={class:"cart__block"},ie={class:"cart__orders"},ce={class:"cart__total"},de=e("p",null,[b("Доставка: "),e("b",null,"бесплатно")],-1),ue=["onClick"],pe={key:0,class:"cart__error form__error-block"},me=e("h4",null,"Заявка не отправлена!",-1),he=e("p",null,"Похоже произошла ошибка. Попробуйте отправить снова или перезагрузите страницу.",-1),ve=[me,he],ye={__name:"CheckoutForm",setup(h){const r=A(),c=y(!1),s=U({name:"",address:"",phone:"",email:"",deliveryTypeId:0,paymentTypeId:0,comment:""});function u(){const l=r.getUser();$.makeOrder(l==null?void 0:l.accessKey,s).then(o=>{console.log(o)})}const _=U({tokens:{A:{pattern:/[A-ZА-ЯЁ]/,transform:l=>l.toLocaleUpperCase()},z:{pattern:/[a-zа-яё]/,transform:l=>l.toLocaleLowerCase(),multiple:!0}}});return(l,o)=>{const i=S("maska");return a(),n("form",G,[e("div",H,[e("div",J,[e("label",Q,[p(e("input",{"data-maska":"Az Az Az",class:"form__input",type:"text",name:"name",placeholder:"Введите ваше полное имя","onUpdate:modelValue":o[0]||(o[0]=t=>s.name=t)},null,512),[[i,void 0,_],[v,s.name]]),W]),e("label",X,[p(e("input",{class:"form__input",type:"text",name:"address",placeholder:"Введите ваш адрес","onUpdate:modelValue":o[1]||(o[1]=t=>s.address=t)},null,512),[[v,s.address]]),Y]),e("label",ee,[p(e("input",{"data-maska":"+7(###) ###-##-##","data-maska-eager":"",class:"form__input",type:"tel",name:"phone",placeholder:"Введите ваш телефон","onUpdate:modelValue":o[2]||(o[2]=t=>s.phone=t)},null,512),[[i],[v,s.phone]]),te,se]),e("label",oe,[p(e("input",{class:"form__input",type:"email",name:"email",placeholder:"Введи ваш Email","onUpdate:modelValue":o[3]||(o[3]=t=>s.email=t)},null,512),[[v,s.email]]),le]),e("label",ae,[p(e("textarea",{class:"form__input form__input--area",name:"comments",placeholder:"Ваши пожелания","onUpdate:modelValue":o[4]||(o[4]=t=>s.comment=t)},null,512),[[v,s.comment]]),ne])]),e("div",re,[k(P,{modelValue:s.deliveryTypeId,"onUpdate:modelValue":o[5]||(o[5]=t=>s.deliveryTypeId=t)},null,8,["modelValue"]),k(Z,{modelValue:s.paymentTypeId,"onUpdate:modelValue":o[6]||(o[6]=t=>s.paymentTypeId=t),deliveryTypeId:s.deliveryTypeId},null,8,["modelValue","deliveryTypeId"])])]),e("div",_e,[e("ul",ie,[(a(!0),n(f,null,T(m(r).cart.items,t=>(a(),n("li",{class:"cart__order",key:t.id},[e("h3",null,d(`${t.product.title} (${t.size.title}) |${t.quantity} шт.`),1),e("b",null,d(l.$format.currRUB(t.price*t.quantity)),1),e("span",null,"Артикул: "+d(m(x).get({id:t.product.id,color:t.color.color.id,size:t.size.id})),1)]))),128))]),e("div",ce,[de,e("p",null,[b(" Итого: "),e("b",null,d(m(r).count),1),b(" "+d(l.$format.countText(m(r).count))+" на сумму ",1),e("b",null,d(l.$format.currRUB(m(r).totalPrice)),1)])]),e("button",{class:"cart__button button button--primery",type:"submit",onClick:B(u,["prevent"])}," Оформить заказ ",8,ue)]),c.value?(a(),n("div",pe,ve)):V("",!0)])}}},fe={class:"content container"},be={class:"content__top"},ke=e("div",{class:"content__row"},[e("h1",{class:"content__title"},"Оформление заказа")],-1),Ve={class:"cart"},Ue={__name:"CheckoutView",setup(h){const r=y([{title:"Каталог",route:{name:"main"}},{title:"Корзина",route:{name:"cart"}},{title:"Оформление заказа",route:{name:"#"}}]);return(c,s)=>(a(),n("main",fe,[e("div",be,[k(z,{links:r.value},null,8,["links"]),ke]),e("section",Ve,[k(ye)])]))}};export{Ue as default};
