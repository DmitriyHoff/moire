import{r as g,c as k,o as i,a as c,b as e,w as V,v as M,u as f,i as I,F as b,d as y,t as $,e as q,f as S,g as R,h as v,j as C,k as w,l as T,R as U,m as B,n as L,p as F,q as z,s as D,x as E}from"./index-b26405f2.js";import{S as x,_ as N,P as j}from"./ProductColors-32a98d4e.js";const A={class:"form__block"},O=e("legend",{class:"form__legend"},"Категория",-1),G={class:"form__label form__label--select"},H=e("option",{value:"0"},"Все категории",-1),J=["value"],K={__name:"FilterCategory",props:["modelValue"],emits:["update:modelValue"],setup(n,{emit:d}){const l=n,a=g(),o=k({get(){return l.modelValue},set(s){d("update:modelValue",s)}});return x.getProductCategories().then(s=>a.value=s),(s,r)=>(i(),c("fieldset",A,[O,e("label",G,[V(e("select",{class:"form__select",name:"category","onUpdate:modelValue":r[0]||(r[0]=t=>I(o)?o.value=t:null)},[H,(i(!0),c(b,null,y(a.value,t=>(i(),c("option",{value:t.id,key:t.id},$(t.title),9,J))),128))],512),[[M,f(o)]])])]))}},Q={class:"form__block"},W=e("legend",{class:"form__legend"},"Цена",-1),X={class:"form__label form__label--price"},Y=["value"],Z=e("span",{class:"form__value"},"От",-1),ee={class:"form__label form__label--price"},te=["value"],se=e("span",{class:"form__value"},"До",-1),le={__name:"FilterPrice",props:["priceFrom","priceTo"],emits:["update:priceFrom","update:priceTo"],setup(n){return(d,l)=>(i(),c("fieldset",Q,[W,e("label",X,[e("input",{class:"form__input",type:"text",name:"min-price",autocomplete:"off",value:n.priceFrom,onInput:l[0]||(l[0]=a=>d.$emit("update:priceFrom",a.target.value))},null,40,Y),Z]),e("label",ee,[e("input",{class:"form__input",type:"text",name:"max-price",autocomplete:"off",value:n.priceTo,onInput:l[1]||(l[1]=a=>d.$emit("update:priceTo",a.target.value))},null,40,te),se])]))}},ae={class:"form__block"},oe=e("legend",{class:"form__legend"},"Материал",-1),ne={class:"check-list"},ie={class:"check-list__label"},re=["value"],ue={class:"check-list__desc"},ce={__name:"FilterMaterial",props:["modelValue"],emits:["update:modelValue"],setup(n,{emit:d}){const l=n,a=g([]),o=k({get(){return l.modelValue},set(s){d("update:modelValue",s)}});return x.getMaterials().then(s=>a.value=s),(s,r)=>(i(),c("fieldset",ae,[oe,e("ul",ne,[(i(!0),c(b,null,y(a.value,t=>(i(),c("li",{key:t.id,class:"check-list__item"},[e("label",ie,[V(e("input",{class:"check-list__check sr-only",type:"checkbox",name:"material",value:t.id,"onUpdate:modelValue":r[0]||(r[0]=_=>I(o)?o.value=_:null)},null,8,re),[[q,f(o)]]),e("span",ue,[S($(t.title),1),e("span",null,"("+$(t.productsCount)+")",1)])])]))),128))])]))}},_e={class:"form__block"},de=e("legend",{class:"form__legend"},"Коллекция",-1),pe={class:"check-list"},me={class:"check-list__label"},ge=["value"],ve={class:"check-list__desc"},fe={__name:"FilterSeasons",props:["modelValue"],emits:["update:modelValue"],setup(n,{emit:d}){const l=n,a=g([]),o=k({get(){return l.modelValue},set(s){d("update:modelValue",s)}});return x.getSeasons().then(s=>a.value=s),(s,r)=>(i(),c("fieldset",_e,[de,e("ul",pe,[(i(!0),c(b,null,y(a.value,t=>(i(),c("li",{key:t.id,class:"check-list__item"},[e("label",me,[V(e("input",{class:"check-list__check sr-only",type:"checkbox",name:"collection",value:t.id,"onUpdate:modelValue":r[0]||(r[0]=_=>I(o)?o.value=_:null)},null,8,ge),[[q,f(o)]]),e("span",ve,[S($(t.title)+" ",1),e("span",null,"("+$(t.productsCount)+")",1)])])]))),128))])]))}},$e={class:"filter"},he={class:"filter__form form",action:"#",method:"get"},ke={__name:"FilterForm",setup(n){const d=R(),l=g(!1),a=g(0),o=g(0),s=g(0),r=g([]),t=g([]),_=k(()=>({...a.value>0?{minPrice:a.value}:{},...o.value>0?{maxPrice:o.value}:{},...s.value>0?{categoryId:s.value}:{},...r.value.length>0?{"materialIds[]":r.value}:{},...t.value.length>0?{"seasonIds[]":t.value}:{}}));function p(){a.value=0,o.value=0,s.value=0,r.value=[],t.value=[],l.value=!1,d.replace({query:_.value})}function h(P=!0){l.value=P}return(P,u)=>(i(),c("aside",$e,[e("form",he,[v(le,{priceFrom:a.value,"onUpdate:priceFrom":u[0]||(u[0]=m=>a.value=m),priceTo:o.value,"onUpdate:priceTo":u[1]||(u[1]=m=>o.value=m),onInput:u[2]||(u[2]=m=>h())},null,8,["priceFrom","priceTo"]),v(K,{modelValue:s.value,"onUpdate:modelValue":u[3]||(u[3]=m=>s.value=m),onChange:u[4]||(u[4]=m=>h())},null,8,["modelValue"]),v(ce,{modelValue:r.value,"onUpdate:modelValue":u[5]||(u[5]=m=>r.value=m),onChange:u[6]||(u[6]=m=>h())},null,8,["modelValue"]),v(fe,{modelValue:t.value,"onUpdate:modelValue":u[7]||(u[7]=m=>t.value=m),onChange:u[8]||(u[8]=m=>h())},null,8,["modelValue"]),e("button",{class:"filter__submit button button--primery",type:"submit",onClick:u[9]||(u[9]=C(m=>P.$router.replace({query:f(_)}),["prevent"]))}," Применить "),l.value?(i(),c("button",{key:0,class:"filter__reset button button--second",type:"button",onClick:u[10]||(u[10]=C(m=>p(),["prevent"]))}," Сбросить ")):w("",!0)])]))}},be={class:"catalog__item"},Ve=["src","alt"],ye={class:"catalog__title"},Ce={class:"catalog__price"},xe={__name:"CatalogItem",props:["product"],setup(n){return(d,l)=>(i(),c("li",be,[v(f(U),{class:"catalog__pic",to:{name:"product",params:{id:n.product.id}}},{default:T(()=>[e("img",{src:n.product.colors[0].gallery?n.product.colors[0].gallery[0].file.url:"/src/assets/no-image.svg",alt:n.product.title},null,8,Ve)]),_:1},8,["to"]),e("h3",ye,[v(f(U),{to:{name:"product",params:{id:n.product.id}}},{default:T(()=>[S($(n.product.title),1)]),_:1},8,["to"])]),e("span",Ce,$(n.product.price)+" ₽ ",1),v(N,{colors:n.product.colors},null,8,["colors"])]))}},Pe={class:"catalog__list"},Fe={__name:"CatalogList",props:["products"],setup(n){return(d,l)=>(i(),c("ul",Pe,[(i(!0),c(b,null,y(n.products,a=>(i(),B(xe,{product:a,key:a.id},null,8,["product"]))),128))]))}},we={class:"catalog__pagination pagination"},Ie={class:"pagination__item"},Se={symbol:"icon-arrow-left",size:"0 0 8 14"},Te={class:"pagination__item"},Ue={symbol:"icon-arrow-right",size:"0 0 8 14"},qe={__name:"CatalogPagination",props:["page","count","perPage"],emits:["pagination"],setup(n,{emit:d}){const l=n,a=k(()=>l.page<l.count),o=k(()=>l.page>1);function s(r){let t;if(r==="next"){if(l.page===l.count)return;t=l.page+1}else if(r==="prev"){if(l.page===1)return;t=l.page-1}else t=r;d("pagination",t)}return(r,t)=>{const _=L("svg");return i(),c("ul",we,[e("li",Ie,[e("a",{class:F(["pagination__link pagination__link--arrow",f(o)?"":"pagination__link--disabled"]),"aria-label":"Предыдущая страница",onClick:t[0]||(t[0]=C(p=>s("prev"),["prevent"]))},[V((i(),c("svg",Se,null,512)),[[_]])],2)]),(i(!0),c(b,null,y(n.count,p=>(i(),c("li",{class:"pagination__item",key:p},[e("a",{class:F(["pagination__link",{"pagination__link--current":p===n.page}])},$(p),3)]))),128)),e("li",Te,[e("a",{class:F(["pagination__link pagination__link--arrow",f(a)?"":"pagination__link--disabled"]),href:"#","aria-label":"Следующая страница",onClick:t[1]||(t[1]=C(p=>s("next"),["prevent"]))},[V((i(),c("svg",Ue,null,512)),[[_]])],2)])])}}},Be={key:1,class:"content container"},Me={class:"content__top"},Re={class:"content__row"},Le=e("h1",{class:"content__title"},"Каталог",-1),ze={class:"content__info"},De={class:"content__catalog"},Ee={class:"catalog"},Ae={__name:"CatalogView",setup(n){const d=g(!0),l=g({}),a=g(12),o=z({page:1,pages:1,total:0}),s=D();E(()=>({params:s.params,query:s.query}),()=>r()),r();function r(){s.params.limit&&s.params.page&&(a.value=parseInt(s.params.limit),o.page=parseInt(s.params.page)),x.getProducts({page:o.page,limit:a.value},s.query).then(_=>{d.value=!0,l.value=_.items,Object.assign(o,_.pagination),d.value=!1})}const t=k(()=>{const _=o.total%100;let p="";return _>=10&&_<=20?p="товаров":_%10===1||(_%10>1&&_%10<5?p="товара":p="товаров"),`${_} ${p}`});return(_,p)=>(i(),c(b,null,[d.value?(i(),B(j,{key:0})):w("",!0),d.value?w("",!0):(i(),c("main",Be,[e("div",Me,[e("div",Re,[Le,e("span",ze,$(f(t)),1)])]),e("div",De,[v(ke),e("section",Ee,[v(Fe,{products:l.value},null,8,["products"]),v(qe,{page:o.page,count:o.pages,perPage:a.value,onPagination:p[0]||(p[0]=h=>_.$router.push({name:"products:limit",params:{limit:a.value,page:h}}))},null,8,["page","count","perPage"])])])]))],64))}};export{Ae as default};
