import{_ as A}from"./BreadcrumbTrail-467ca9df.js";import{r as k,c as w,S as I,o as r,a as n,t as _,l as m,F as q,d as U,b as e,w as f,D as z,u as v,i as R,f as g,y as D,C as S,g as E,x as T,B as b,j as $,q as L,k as M,s as N}from"./index-ffbe57d3.js";import{g as O}from"./color-dictionary-6d7c63d4.js";const P={class:"cart__option-item"},F=e("h3",{class:"cart__title"},"Доставка",-1),j={key:0,class:"form__error"},K={key:1,class:"cart__options options"},W={class:"options__label"},Z=["value"],G={class:"options__value"},H={key:0},J={__name:"CheckoutDelivery",props:["modelValue","error"],emits:["update:modelValue"],setup(d,{emit:c}){const u=d,p=k(!1);p.value=!0;const i=k({}),a=w({get(){return u.modelValue},set(s){c("update:modelValue",s)}});return I.getDeliveries().then(s=>{i.value=s,p.value=!1}),(s,h)=>{var y,l;return r(),n("li",P,[F,(y=d.error.request)!=null&&y.deliveryTypeId?(r(),n("p",j,_((l=d.error.request)==null?void 0:l.deliveryTypeId),1)):m("",!0),p.value?m("",!0):(r(),n("ul",K,[(r(!0),n(q,null,U(i.value,t=>(r(),n("li",{class:"options__item",key:t.id},[e("label",W,[f(e("input",{class:"options__radio sr-only",type:"radio",name:"delivery",value:t.id,"onUpdate:modelValue":h[0]||(h[0]=V=>R(a)?a.value=V:null)},null,8,Z),[[z,v(a)]]),e("span",G,[g(_(t.title)+" ",1),t.price>0?(r(),n("strong",H,_(s.$format.currRUB(t.price)),1)):m("",!0)])])]))),128))]))])}}},Q={class:"cart__option-item"},Y=e("h3",{class:"cart__title"},"Оплата",-1),ee={key:0,class:"form__error"},te={class:"cart__options options"},se={class:"options__label"},oe=["value"],ae={class:"options__value"},le={__name:"CheckoutPayment",props:["modelValue","deliveryTypeId","error"],emits:["update:modelValue"],setup(d,{emit:c}){const u=d,p=k({});D(()=>u.deliveryTypeId,()=>{console.log(u.deliveryTypeId),I.getPayments(u.deliveryTypeId).then(a=>{console.log("pay",a),p.value=a})});const i=w({get(){return u.modelValue},set(a){c("update:modelValue",a)}});return(a,s)=>{var h,y;return r(),n("li",Q,[Y,(h=d.error.request)!=null&&h.paymentTypeId?(r(),n("p",ee,_((y=d.error.request)==null?void 0:y.paymentTypeId),1)):m("",!0),e("ul",te,[(r(!0),n(q,null,U(p.value,l=>(r(),n("li",{key:l.id,class:"options__item"},[e("label",se,[f(e("input",{class:"options__radio sr-only",type:"radio",name:"pay",value:l.id,"onUpdate:modelValue":s[0]||(s[0]=t=>R(i)?i.value=t:null)},null,8,oe),[[z,v(i)]]),e("span",ae,_(l.title),1)])]))),128))])])}}},re={class:"cart__form form",action:"#",method:"POST"},ne={class:"cart__field"},_e={class:"cart__data"},ce={class:"form__label"},ie=e("span",{class:"form__value"},"ФИО",-1),de={key:0,class:"form__error"},ue={class:"form__label"},pe=e("span",{class:"form__value"},"Адрес доставки",-1),me={key:0,class:"form__error"},he={class:"form__label"},ye=e("span",{class:"form__value"},"Телефон",-1),fe={key:0,class:"form__error"},ve={class:"form__label"},ke=e("span",{class:"form__value"},"Email",-1),be={key:0,class:"form__error"},Ve={class:"form__label"},$e=e("span",{class:"form__value"},"Комментарий к заказу",-1),Te={class:"cart__options"},ge={class:"cart__block"},Ie={class:"cart__orders"},qe={class:"cart__sku"},Ue={class:"cart__total-count"},Ce={class:"cart__total"},Xe=e("p",null,"Доставка:",-1),xe=e("p",{class:"cart__order-price"},"бесплатно",-1),Be={class:"cart__order-price"},we=["onClick"],ze=e("span",{class:"button__text"},"Оформить заказ",-1),Re=[ze],Ae={key:0,class:"cart__error form__error-block"},De=e("h4",null,"Заявка не отправлена!",-1),Se=e("p",null,"Похоже произошла ошибка. Попробуйте отправить снова или перезагрузите страницу.",-1),Ee=[De,Se],Le={__name:"CheckoutForm",setup(d){const c=S(),u=E(),p=k(!1),i=k(!1),a=T({}),s=T({name:"",address:"",phone:"",email:"",deliveryTypeId:0,paymentTypeId:0,comment:""});function h(){i.value=!0;const l=c.getUser();I.makeOrder(l==null?void 0:l.accessKey,s).then(t=>{console.log(t),t.error?Object.assign(a,t.error):u.push({name:"order",params:{id:t.id}}),i.value=!1})}const y=T({tokens:{A:{pattern:/[A-ZА-ЯЁ]/,transform:l=>l.toLocaleUpperCase()},z:{pattern:/[a-zа-яё]/,transform:l=>l.toLocaleLowerCase(),multiple:!0}}});return(l,t)=>{var C,X,x,B;const V=N("maska");return r(),n("form",re,[e("div",ne,[e("div",_e,[e("label",ce,[f(e("input",{"data-maska":"Az Az Az",class:"form__input",type:"text",name:"name",placeholder:"Введите ваше полное имя","onUpdate:modelValue":t[0]||(t[0]=o=>s.name=o)},null,512),[[V,void 0,y],[b,s.name]]),ie,(C=a.request)!=null&&C.name?(r(),n("span",de,_(a.request.name),1)):m("",!0)]),e("label",ue,[f(e("input",{class:"form__input",type:"text",name:"address",placeholder:"Введите ваш адрес","onUpdate:modelValue":t[1]||(t[1]=o=>s.address=o)},null,512),[[b,s.address]]),pe,(X=a.request)!=null&&X.address?(r(),n("span",me,_(a.request.address),1)):m("",!0)]),e("label",he,[f(e("input",{"data-maska":"+7(###) ###-##-##","data-maska-eager":"",class:"form__input",type:"tel",name:"phone",placeholder:"+7(XXX) XXX-XX-XX","onUpdate:modelValue":t[2]||(t[2]=o=>s.phone=o)},null,512),[[V],[b,s.phone]]),ye,(x=a.request)!=null&&x.phone?(r(),n("span",fe,_(a.request.phone),1)):m("",!0)]),e("label",ve,[f(e("input",{class:"form__input",type:"email",name:"email",placeholder:"Введи ваш Email","onUpdate:modelValue":t[3]||(t[3]=o=>s.email=o)},null,512),[[b,s.email]]),ke,(B=a.request)!=null&&B.email?(r(),n("span",be,_(a.request.email),1)):m("",!0)]),e("label",Ve,[f(e("textarea",{class:"form__input form__input--area",name:"comments",placeholder:"Ваши пожелания","onUpdate:modelValue":t[4]||(t[4]=o=>s.comment=o)},null,512),[[b,s.comment]]),$e])]),e("ul",Te,[$(J,{modelValue:s.deliveryTypeId,"onUpdate:modelValue":t[5]||(t[5]=o=>s.deliveryTypeId=o),error:a},null,8,["modelValue","error"]),$(le,{modelValue:s.paymentTypeId,"onUpdate:modelValue":t[6]||(t[6]=o=>s.paymentTypeId=o),deliveryTypeId:s.deliveryTypeId,error:a},null,8,["modelValue","deliveryTypeId","error"])])]),e("div",ge,[e("ul",Ie,[(r(!0),n(q,null,U(v(c).cart.items,o=>(r(),n("li",{class:"cart__order",key:o.id},[e("h3",null,_(o.product.title),1),e("b",null,_(l.$format.currRUB(o.price*o.quantity)),1),e("p",qe,[e("span",null,"Цвет: "+_(v(O)(o.product.colors[0].color.title)),1),e("span",null,"Размер: "+_(o.size.title),1)]),e("span",Ue,_(o.quantity)+" шт. × "+_(l.$format.currRUB(o.price)),1)]))),128))]),e("div",Ce,[Xe,xe,e("p",null,[g(" Итого: "),e("b",null,_(v(c).count),1),g(" "+_(l.$format.countText(v(c).count))+" на сумму: ",1)]),e("p",Be,_(l.$format.currRUB(v(c).totalPrice)),1)]),e("button",{class:L(["cart__button button button--primery",i.value?"button--loading":""]),type:"submit",onClick:M(h,["prevent"])},Re,10,we)]),p.value?(r(),n("div",Ae,Ee)):m("",!0)])}}},Me={class:"content container"},Ne={class:"content__top"},Oe=e("div",{class:"content__row"},[e("h1",{class:"content__title"},"Оформление заказа")],-1),Pe={class:"cart"},We={__name:"CheckoutView",setup(d){const c=k([{title:"Каталог",route:{name:"main"}},{title:"Корзина",route:{name:"cart"}},{title:"Оформление заказа",route:{name:"#"}}]);return(u,p)=>(r(),n("main",Me,[e("div",Ne,[$(A,{links:c.value},null,8,["links"]),Oe]),e("section",Pe,[$(Le)])]))}};export{We as default};
