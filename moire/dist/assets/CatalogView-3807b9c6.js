import{r as g,c as y,S,o as d,a as p,b as r,w as x,v as ie,u as v,i as M,F as V,d as N,t as $,e as H,f as R,g as ae,h,j as C,k as I,l as U,R as O,m as J,n as B,p as le,q as re,s as ue,x as ce}from"./index-9e1c7b37.js";import{_ as de,P as me}from"./ProductColors-49e9dc72.js";import{n as pe}from"./no-image-7601bee4.js";import"./_plugin-vue_export-helper-c27b6911.js";const _e={class:"form__block"},fe=r("legend",{class:"form__legend"},"Категория",-1),ge={class:"form__label form__label--select"},ve=r("option",{value:"0"},"Все категории",-1),he=["value"],be={__name:"FilterCategory",props:["modelValue"],emits:["update:modelValue"],setup(t,{emit:e}){const n=t,s=g(),i=y({get(){return n.modelValue},set(o){e("update:modelValue",o)}});return S.getProductCategories().then(o=>s.value=o),(o,l)=>(d(),p("fieldset",_e,[fe,r("label",ge,[x(r("select",{class:"form__select",name:"category","onUpdate:modelValue":l[0]||(l[0]=a=>M(i)?i.value=a:null)},[ve,(d(!0),p(V,null,N(s.value,a=>(d(),p("option",{value:a.id,key:a.id},$(a.title),9,he))),128))],512),[[ie,v(i)]])])]))}};var $e=Object.defineProperty,ke=(t,e,n)=>e in t?$e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,D=(t,e,n)=>(ke(t,typeof e!="symbol"?e+"":e,n),n);const F={debug:!1,masked:!1,prefix:"",suffix:"",thousands:",",decimal:".",precision:2,disableNegative:!1,disabled:!1,min:null,max:null,allowBlank:!1,minimumNumberOfCharacters:0,modelModifiers:{number:!1},shouldRound:!0,focusOnRight:!1},K=["+","-"],Q=["decimal","thousands","prefix","suffix"];function k(t){return Math.max(0,Math.min(t,1e3))}function P(t,e){return t=t.padStart(e+1,"0"),e===0?t:`${t.slice(0,-e)}.${t.slice(-e)}`}function X(t){return t=t?t.toString():"",t.replace(/\D+/g,"")||"0"}function ye(t,e){return t.replace(/(\d)(?=(?:\d{3})+\b)/gm,`$1${e}`)}function xe(t,e,n){return e?t+n+e:t}function we(t,e){return K.includes(t)?(console.warn(`v-money3 "${e}" property don't accept "${t}" as a value.`),!1):/\d/g.test(t)?(console.warn(`v-money3 "${e}" property don't accept "${t}" (any number) as a value.`),!1):!0}function Ve(t){for(const e of Q)if(!we(t[e],e))return!1;return!0}function q(t){for(const e of Q){t[e]=t[e].replace(/\d+/g,"");for(const n of K)t[e]=t[e].replaceAll(n,"")}return t}function Y(t){const e=t.length,n=t.indexOf(".");return e-(n+1)}function j(t){return t.replace(/^(-?)0+(?!\.)(.+)/,"$1$2")}function ee(t){return/^-?[\d]+$/g.test(t)}function te(t){return/^-?[\d]+(\.[\d]+)$/g.test(t)}function A(t,e,n){return e>t.length-1?t:t.substring(0,e)+n+t.substring(e+1)}function ne(t,e){const n=e-Y(t);if(n>=0)return t;let s=t.slice(0,n);const i=t.slice(n);if(s.charAt(s.length-1)==="."&&(s=s.slice(0,-1)),parseInt(i.charAt(0),10)>=5){for(let o=s.length-1;o>=0;o-=1){const l=s.charAt(o);if(l!=="."&&l!=="-"){const a=parseInt(l,10)+1;if(a<10)return A(s,o,a);s=A(s,o,"0")}}return`1${s}`}return s}function se(t,e){const n=()=>{t.setSelectionRange(e,e)};t===document.activeElement&&(n(),setTimeout(n,1))}function oe(t){return new Event(t,{bubbles:!0,cancelable:!1})}function u({debug:t=!1},...e){t&&console.log(...e)}class T{constructor(e){D(this,"number",0n),D(this,"decimal",0),this.setNumber(e)}getNumber(){return this.number}getDecimalPrecision(){return this.decimal}setNumber(e){this.decimal=0,typeof e=="bigint"?this.number=e:typeof e=="number"?this.setupString(e.toString()):this.setupString(e)}toFixed(e=0,n=!0){let s=this.toString();const i=e-this.getDecimalPrecision();return i>0?(s.includes(".")||(s+="."),s.padEnd(s.length+i,"0")):i<0?n?ne(s,e):s.slice(0,i):s}toString(){let e=this.number.toString();if(this.decimal){let n=!1;return e.charAt(0)==="-"&&(e=e.substring(1),n=!0),e=e.padStart(e.length+this.decimal,"0"),e=`${e.slice(0,-this.decimal)}.${e.slice(-this.decimal)}`,e=j(e),(n?"-":"")+e}return e}lessThan(e){const[n,s]=this.adjustComparisonNumbers(e);return n<s}biggerThan(e){const[n,s]=this.adjustComparisonNumbers(e);return n>s}isEqual(e){const[n,s]=this.adjustComparisonNumbers(e);return n===s}setupString(e){if(e=j(e),ee(e))this.number=BigInt(e);else if(te(e))this.decimal=Y(e),this.number=BigInt(e.replace(".",""));else throw new Error(`BigNumber has received and invalid format for the constructor: ${e}`)}adjustComparisonNumbers(e){let n;e.constructor.name!=="BigNumber"?n=new T(e):n=e;const s=this.getDecimalPrecision()-n.getDecimalPrecision();let i=this.getNumber(),o=n.getNumber();return s>0?o=n.getNumber()*10n**BigInt(s):s<0&&(i=this.getNumber()*10n**BigInt(s*-1)),[i,o]}}function Ne(t,e=F,n=""){if(u(e,"utils format() - caller",n),u(e,"utils format() - input1",t),t==null)t="";else if(typeof t=="number")e.shouldRound?t=t.toFixed(k(e.precision)):t=t.toFixed(k(e.precision)+1).slice(0,-1);else if(e.modelModifiers&&e.modelModifiers.number&&ee(t))t=Number(t).toFixed(k(e.precision));else if(!e.disableNegative&&t==="-")return t;u(e,"utils format() - input2",t);const s=e.disableNegative?"":t.indexOf("-")>=0?"-":"";let i=t.replace(e.prefix,"").replace(e.suffix,"");u(e,"utils format() - filtered",i),!e.precision&&e.thousands!=="."&&te(i)&&(i=ne(i,0),u(e,"utils format() - !opt.precision && isValidFloat()",i));const o=X(i);u(e,"utils format() - numbers",o),u(e,"utils format() - numbersToCurrency",s+P(o,e.precision));const l=new T(s+P(o,e.precision));u(e,"utils format() - bigNumber1",l.toString()),e.max&&l.biggerThan(e.max)&&l.setNumber(e.max),e.min&&l.lessThan(e.min)&&l.setNumber(e.min);const a=l.toFixed(k(e.precision),e.shouldRound);if(u(e,"utils format() - bigNumber2",l.toFixed(k(e.precision))),/^0(\.0+)?$/g.test(a)&&e.allowBlank)return"";let[c,_]=a.split(".");const b=_!==void 0?_.length:0;c=c.padStart(e.minimumNumberOfCharacters-b,"0"),c=ye(c,e.thousands);const w=e.prefix+xe(c,_,e.decimal)+e.suffix;return u(e,"utils format() - output",w),w}function L(t,e=F,n=""){if(u(e,"utils unformat() - caller",n),u(e,"utils unformat() - input",t),!e.disableNegative&&t==="-")return u(e,"utils unformat() - return netagive symbol",t),t;const s=e.disableNegative?"":t.indexOf("-")>=0?"-":"",i=t.replace(e.prefix,"").replace(e.suffix,"");u(e,"utils unformat() - filtered",i);const o=X(i);u(e,"utils unformat() - numbers",o);const l=new T(s+P(o,e.precision));u(e,"utils unformat() - bigNumber1",o.toString()),e.max&&l.biggerThan(e.max)&&l.setNumber(e.max),e.min&&l.lessThan(e.min)&&l.setNumber(e.min);let a=l.toFixed(k(e.precision),e.shouldRound);return e.modelModifiers&&e.modelModifiers.number&&(a=parseFloat(a)),u(e,"utils unformat() - output",a),a}const E=(t,e,n)=>{if(u(e,"directive setValue() - caller",n),!Ve(e)){u(e,"directive setValue() - validateRestrictedOptions() return false. Stopping here...",t.value);return}let s=t.value.length-(t.selectionEnd||0);t.value=Ne(t.value,e,n),s=Math.max(s,e.suffix.length),s=t.value.length-s,s=Math.max(s,e.prefix.length),se(t,s),t.dispatchEvent(oe("change"))},z=(t,e)=>{const n=t.currentTarget,s=t.code==="Backspace"||t.code==="Delete",i=n.value.length-(n.selectionEnd||0)===0;if(u(e,"directive onkeydown() - el.value",n.value),u(e,"directive onkeydown() - backspacePressed",s),u(e,"directive onkeydown() - isAtEndPosition",i),e.allowBlank&&s&&i&&L(n.value,e,"directive onkeydown allowBlank")===0&&(u(e,'directive onkeydown() - set el.value = ""',n.value),n.value="",n.dispatchEvent(oe("change"))),u(e,"directive onkeydown() - e.key",t.key),t.key==="+"){u(e,"directive onkeydown() - unformat el.value",n.value);let o=L(n.value,e,"directive onkeydown +");typeof o=="string"&&(o=parseFloat(o)),o<0&&(n.value=String(o*-1))}},W=(t,e)=>{const n=t.currentTarget;u(e,"directive oninput()",n.value),/^[1-9]$/.test(n.value)&&(n.value=P(n.value,k(e.precision)),u(e,"directive oninput() - is 1-9",n.value)),E(n,e,"directive oninput")},Z=(t,e)=>{const n=t.currentTarget;u(e,"directive onFocus()",n.value),e.focusOnRight&&se(n,n.value.length-e.suffix.length)},G={mounted(t,e){if(!e.value)return;const n=q({...F,...e.value});if(u(n,"directive mounted() - opt",n),t.tagName.toLocaleUpperCase()!=="INPUT"){const s=t.getElementsByTagName("input");s.length!==1||(t=s[0])}t.onkeydown=s=>{z(s,n)},t.oninput=s=>{W(s,n)},t.onfocus=s=>{Z(s,n)},u(n,"directive mounted() - el.value",t.value),E(t,n,"directive mounted")},updated(t,e){if(!e.value)return;const n=q({...F,...e.value});t.onkeydown=s=>{z(s,n)},t.oninput=s=>{W(s,n)},t.onfocus=s=>{Z(s,n)},u(n,"directive updated() - el.value",t.value),u(n,"directive updated() - opt",n),E(t,n,"directive updated")},beforeUnmount(t){t.onkeydown=null,t.oninput=null,t.onfocus=null}},Ce={class:"form__block"},Fe=r("legend",{class:"form__legend"},"Цена",-1),Pe={class:"form__label form__label--price"},Se=["value"],Te=r("span",{class:"form__value"},"От",-1),Be={class:"form__label form__label--price"},Ie=["value"],Ee=r("span",{class:"form__value"},"До",-1),Me={__name:"FilterPrice",props:["priceFrom","priceTo"],emits:["update:priceFrom","update:priceTo"],setup(t){return(e,n)=>(d(),p("fieldset",Ce,[Fe,r("label",Pe,[x(r("input",{"data-maska":"000 000 00#","data-maska-tokens":"0:[0-9]:optional",reversed:"",class:"form__input",type:"text",name:"min-price",autocomplete:"off",value:t.priceFrom,onInput:n[0]||(n[0]=s=>e.$emit("update:priceFrom",s.target.value))},null,40,Se),[[v(G),{precision:0,thousands:""}]]),Te]),r("label",Be,[x(r("input",{class:"form__input",type:"text",name:"max-price",autocomplete:"off",value:t.priceTo,onInput:n[1]||(n[1]=s=>e.$emit("update:priceTo",s.target.value))},null,40,Ie),[[v(G),{precision:0,thousands:""}]]),Ee])]))}},Re={class:"form__block"},Ue=r("legend",{class:"form__legend"},"Материал",-1),Oe={class:"check-list"},De={class:"check-list__label"},qe=["value"],je={class:"check-list__desc"},Ae={__name:"FilterMaterial",props:["modelValue"],emits:["update:modelValue"],setup(t,{emit:e}){const n=t,s=g([]),i=y({get(){return n.modelValue},set(o){e("update:modelValue",o)}});return S.getMaterials().then(o=>s.value=o),(o,l)=>(d(),p("fieldset",Re,[Ue,r("ul",Oe,[(d(!0),p(V,null,N(s.value,a=>(d(),p("li",{key:a.id,class:"check-list__item"},[r("label",De,[x(r("input",{class:"check-list__check sr-only",type:"checkbox",name:"material",value:a.id,"onUpdate:modelValue":l[0]||(l[0]=c=>M(i)?i.value=c:null)},null,8,qe),[[H,v(i)]]),r("span",je,[R($(a.title),1),r("span",null,"("+$(a.productsCount)+")",1)])])]))),128))])]))}},Le={class:"form__block"},ze=r("legend",{class:"form__legend"},"Коллекция",-1),We={class:"check-list"},Ze={class:"check-list__label"},Ge=["value"],He={class:"check-list__desc"},Je={__name:"FilterSeasons",props:["modelValue"],emits:["update:modelValue"],setup(t,{emit:e}){const n=t,s=g([]),i=y({get(){return n.modelValue},set(o){e("update:modelValue",o)}});return S.getSeasons().then(o=>s.value=o),(o,l)=>(d(),p("fieldset",Le,[ze,r("ul",We,[(d(!0),p(V,null,N(s.value,a=>(d(),p("li",{key:a.id,class:"check-list__item"},[r("label",Ze,[x(r("input",{class:"check-list__check sr-only",type:"checkbox",name:"collection",value:a.id,"onUpdate:modelValue":l[0]||(l[0]=c=>M(i)?i.value=c:null)},null,8,Ge),[[H,v(i)]]),r("span",He,[R($(a.title)+" ",1),r("span",null,"("+$(a.productsCount)+")",1)])])]))),128))])]))}},Ke={class:"filter"},Qe={class:"filter__form form",action:"#",method:"get"},Xe={__name:"FilterForm",setup(t){const e=ae(),n=g(!1),s=g(0),i=g(0),o=g(0),l=g([]),a=g([]),c=y(()=>({...s.value>0?{minPrice:s.value}:{},...i.value>0?{maxPrice:i.value}:{},...o.value>0?{categoryId:o.value}:{},...l.value.length>0?{"materialIds[]":l.value}:{},...a.value.length>0?{"seasonIds[]":a.value}:{}}));function _(){s.value=0,i.value=0,o.value=0,l.value=[],a.value=[],n.value=!1,e.replace({query:c.value})}function b(w=!0){n.value=w}return(w,m)=>(d(),p("aside",Ke,[r("form",Qe,[h(Me,{priceFrom:s.value,"onUpdate:priceFrom":m[0]||(m[0]=f=>s.value=f),priceTo:i.value,"onUpdate:priceTo":m[1]||(m[1]=f=>i.value=f),onInput:m[2]||(m[2]=f=>b())},null,8,["priceFrom","priceTo"]),h(be,{modelValue:o.value,"onUpdate:modelValue":m[3]||(m[3]=f=>o.value=f),onChange:m[4]||(m[4]=f=>b())},null,8,["modelValue"]),h(Ae,{modelValue:l.value,"onUpdate:modelValue":m[5]||(m[5]=f=>l.value=f),onChange:m[6]||(m[6]=f=>b())},null,8,["modelValue"]),h(Je,{modelValue:a.value,"onUpdate:modelValue":m[7]||(m[7]=f=>a.value=f),onChange:m[8]||(m[8]=f=>b())},null,8,["modelValue"]),r("button",{class:"filter__submit button button--primery",type:"submit",onClick:m[9]||(m[9]=C(f=>w.$router.replace({query:v(c)}),["prevent"]))}," Применить "),n.value?(d(),p("button",{key:0,class:"filter__reset button button--second",type:"button",onClick:m[10]||(m[10]=C(f=>_(),["prevent"]))}," Сбросить ")):I("",!0)])]))}},Ye={class:"catalog__item"},et=["src","alt"],tt={class:"catalog__item-content"},nt={class:"catalog__title"},st={class:"catalog__price"},ot={__name:"CatalogItem",props:["product"],setup(t){return(e,n)=>(d(),p("li",Ye,[h(v(O),{class:"catalog__pic",to:{name:"product",params:{id:t.product.id},meta:{title:t.product.title}}},{default:U(()=>[r("img",{src:t.product.colors[0].gallery?t.product.colors[0].gallery[0].file.url:v(pe),alt:t.product.title},null,8,et)]),_:1},8,["to"]),r("div",tt,[r("h3",nt,[h(v(O),{to:{name:"product",params:{id:t.product.id},meta:{title:t.product.title}}},{default:U(()=>[R($(t.product.title),1)]),_:1},8,["to"])]),r("span",st,$(e.$format.currRUB(t.product.price)),1),h(de,{colors:t.product.colors},null,8,["colors"])])]))}},it={class:"catalog__list"},at={__name:"CatalogList",props:["products"],setup(t){return(e,n)=>(d(),p("ul",it,[(d(!0),p(V,null,N(t.products,s=>(d(),J(ot,{product:s,key:s.id},null,8,["product"]))),128))]))}},lt={class:"catalog__pagination pagination"},rt={class:"pagination__item"},ut={symbol:"icon-arrow-left",size:"0 0 8 14"},ct={class:"pagination__item"},dt={symbol:"icon-arrow-right",size:"0 0 8 14"},mt={__name:"CatalogPagination",props:["page","count","perPage"],emits:["pagination"],setup(t,{emit:e}){const n=t,s=y(()=>n.page<n.count),i=y(()=>n.page>1);function o(l){let a;if(l==="next"){if(n.page===n.count)return;a=n.page+1}else if(l==="prev"){if(n.page===1)return;a=n.page-1}else a=l;e("pagination",a)}return(l,a)=>{const c=le("svg");return d(),p("ul",lt,[r("li",rt,[r("a",{class:B(["pagination__link pagination__link--arrow",v(i)?"":"pagination__link--disabled"]),"aria-label":"Предыдущая страница",onClick:a[0]||(a[0]=C(_=>o("prev"),["prevent"]))},[x((d(),p("svg",ut,null,512)),[[c]])],2)]),(d(!0),p(V,null,N(t.count,_=>(d(),p("li",{class:"pagination__item",key:_},[r("a",{class:B(["pagination__link",{"pagination__link--current":_===t.page}])},$(_),3)]))),128)),r("li",ct,[r("a",{class:B(["pagination__link pagination__link--arrow",v(s)?"":"pagination__link--disabled"]),href:"#","aria-label":"Следующая страница",onClick:a[1]||(a[1]=C(_=>o("next"),["prevent"]))},[x((d(),p("svg",dt,null,512)),[[c]])],2)])])}}},pt={key:1,class:"content container"},_t={class:"content__top"},ft={class:"content__row"},gt=r("h1",{class:"content__title"},"Каталог",-1),vt={class:"content__info"},ht={class:"content__catalog"},bt={class:"catalog"},wt={__name:"CatalogView",setup(t){const e=g(!0),n=g({}),s=g(12),i=re({page:1,pages:1,total:0}),o=ue();ce(()=>({params:o.params,query:o.query}),l),l();function l(){o.params.limit&&o.params.page&&(s.value=parseInt(o.params.limit),i.page=parseInt(o.params.page)),S.getProducts({page:i.page,limit:s.value},o.query).then(c=>{console.log(c),e.value=!0,n.value=c.items,Object.assign(i,c.pagination),e.value=!1})}const a=y(()=>{const c=i.total%100;let _="";return c>=10&&c<=20?_="товаров":c%10===1?_="товар":c%10>1&&c%10<5?_="товара":_="товаров",`${c} ${_}`});return(c,_)=>(d(),p(V,null,[e.value?(d(),J(me,{key:0})):I("",!0),e.value?I("",!0):(d(),p("main",pt,[r("div",_t,[r("div",ft,[gt,r("span",vt,$(v(a)),1)])]),r("div",ht,[h(Xe),r("section",bt,[h(at,{products:n.value},null,8,["products"]),h(mt,{page:i.page,count:i.pages,perPage:s.value,onPagination:_[0]||(_[0]=b=>c.$router.push({name:"products:limit",params:{limit:s.value,page:b}}))},null,8,["page","count","perPage"])])])]))],64))}};export{wt as default};
