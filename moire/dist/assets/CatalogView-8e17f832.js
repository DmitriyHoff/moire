import{r as g,c as k,S as x,o as i,a as _,b as e,w as V,v as R,u as f,i as I,F as b,d as y,t as $,e as q,f as U,g as L,h as v,j as C,k as w,l as S,R as T,m as B,n as F,p as M,q as z,s as D,x as E}from"./index-4fc75948.js";import{_ as N,P as j}from"./ProductColors-d59583e0.js";import"./_plugin-vue_export-helper-c27b6911.js";const A={class:"form__block"},O=e("legend",{class:"form__legend"},"Категория",-1),G={class:"form__label form__label--select"},H=e("option",{value:"0"},"Все категории",-1),J=["value"],K={__name:"FilterCategory",props:["modelValue"],emits:["update:modelValue"],setup(o,{emit:d}){const a=o,l=g(),n=k({get(){return a.modelValue},set(s){d("update:modelValue",s)}});return x.getProductCategories().then(s=>l.value=s),(s,r)=>(i(),_("fieldset",A,[O,e("label",G,[V(e("select",{class:"form__select",name:"category","onUpdate:modelValue":r[0]||(r[0]=t=>I(n)?n.value=t:null)},[H,(i(!0),_(b,null,y(l.value,t=>(i(),_("option",{value:t.id,key:t.id},$(t.title),9,J))),128))],512),[[R,f(n)]])])]))}},Q={class:"form__block"},W=e("legend",{class:"form__legend"},"Цена",-1),X={class:"form__label form__label--price"},Y=["value"],Z=e("span",{class:"form__value"},"От",-1),ee={class:"form__label form__label--price"},te=["value"],se=e("span",{class:"form__value"},"До",-1),le={__name:"FilterPrice",props:["priceFrom","priceTo"],emits:["update:priceFrom","update:priceTo"],setup(o){return(d,a)=>(i(),_("fieldset",Q,[W,e("label",X,[e("input",{class:"form__input",type:"text",name:"min-price",autocomplete:"off",value:o.priceFrom,onInput:a[0]||(a[0]=l=>d.$emit("update:priceFrom",l.target.value))},null,40,Y),Z]),e("label",ee,[e("input",{class:"form__input",type:"text",name:"max-price",autocomplete:"off",value:o.priceTo,onInput:a[1]||(a[1]=l=>d.$emit("update:priceTo",l.target.value))},null,40,te),se])]))}},ae={class:"form__block"},oe=e("legend",{class:"form__legend"},"Материал",-1),ne={class:"check-list"},ie={class:"check-list__label"},re=["value"],ue={class:"check-list__desc"},ce={__name:"FilterMaterial",props:["modelValue"],emits:["update:modelValue"],setup(o,{emit:d}){const a=o,l=g([]),n=k({get(){return a.modelValue},set(s){d("update:modelValue",s)}});return x.getMaterials().then(s=>l.value=s),(s,r)=>(i(),_("fieldset",ae,[oe,e("ul",ne,[(i(!0),_(b,null,y(l.value,t=>(i(),_("li",{key:t.id,class:"check-list__item"},[e("label",ie,[V(e("input",{class:"check-list__check sr-only",type:"checkbox",name:"material",value:t.id,"onUpdate:modelValue":r[0]||(r[0]=u=>I(n)?n.value=u:null)},null,8,re),[[q,f(n)]]),e("span",ue,[U($(t.title),1),e("span",null,"("+$(t.productsCount)+")",1)])])]))),128))])]))}},_e={class:"form__block"},de=e("legend",{class:"form__legend"},"Коллекция",-1),pe={class:"check-list"},me={class:"check-list__label"},ge=["value"],ve={class:"check-list__desc"},fe={__name:"FilterSeasons",props:["modelValue"],emits:["update:modelValue"],setup(o,{emit:d}){const a=o,l=g([]),n=k({get(){return a.modelValue},set(s){d("update:modelValue",s)}});return x.getSeasons().then(s=>l.value=s),(s,r)=>(i(),_("fieldset",_e,[de,e("ul",pe,[(i(!0),_(b,null,y(l.value,t=>(i(),_("li",{key:t.id,class:"check-list__item"},[e("label",me,[V(e("input",{class:"check-list__check sr-only",type:"checkbox",name:"collection",value:t.id,"onUpdate:modelValue":r[0]||(r[0]=u=>I(n)?n.value=u:null)},null,8,ge),[[q,f(n)]]),e("span",ve,[U($(t.title)+" ",1),e("span",null,"("+$(t.productsCount)+")",1)])])]))),128))])]))}},$e={class:"filter"},he={class:"filter__form form",action:"#",method:"get"},ke={__name:"FilterForm",setup(o){const d=L(),a=g(!1),l=g(0),n=g(0),s=g(0),r=g([]),t=g([]),u=k(()=>({...l.value>0?{minPrice:l.value}:{},...n.value>0?{maxPrice:n.value}:{},...s.value>0?{categoryId:s.value}:{},...r.value.length>0?{"materialIds[]":r.value}:{},...t.value.length>0?{"seasonIds[]":t.value}:{}}));function p(){l.value=0,n.value=0,s.value=0,r.value=[],t.value=[],a.value=!1,d.replace({query:u.value})}function h(P=!0){a.value=P}return(P,c)=>(i(),_("aside",$e,[e("form",he,[v(le,{priceFrom:l.value,"onUpdate:priceFrom":c[0]||(c[0]=m=>l.value=m),priceTo:n.value,"onUpdate:priceTo":c[1]||(c[1]=m=>n.value=m),onInput:c[2]||(c[2]=m=>h())},null,8,["priceFrom","priceTo"]),v(K,{modelValue:s.value,"onUpdate:modelValue":c[3]||(c[3]=m=>s.value=m),onChange:c[4]||(c[4]=m=>h())},null,8,["modelValue"]),v(ce,{modelValue:r.value,"onUpdate:modelValue":c[5]||(c[5]=m=>r.value=m),onChange:c[6]||(c[6]=m=>h())},null,8,["modelValue"]),v(fe,{modelValue:t.value,"onUpdate:modelValue":c[7]||(c[7]=m=>t.value=m),onChange:c[8]||(c[8]=m=>h())},null,8,["modelValue"]),e("button",{class:"filter__submit button button--primery",type:"submit",onClick:c[9]||(c[9]=C(m=>P.$router.replace({query:f(u)}),["prevent"]))}," Применить "),a.value?(i(),_("button",{key:0,class:"filter__reset button button--second",type:"button",onClick:c[10]||(c[10]=C(m=>p(),["prevent"]))}," Сбросить ")):w("",!0)])]))}},be={class:"catalog__item"},Ve=["src","alt"],ye={class:"catalog__item-content"},Ce={class:"catalog__title"},xe={class:"catalog__price"},Pe={__name:"CatalogItem",props:["product"],setup(o){const d=new URL("/moire/assets/no-image-00277bfe.svg",self.location).href;return(a,l)=>(i(),_("li",be,[v(f(T),{class:"catalog__pic",to:{name:"product",params:{id:o.product.id},state:{title:o.product.title}}},{default:S(()=>[e("img",{src:o.product.colors[0].gallery?o.product.colors[0].gallery[0].file.url:f(d),alt:o.product.title},null,8,Ve)]),_:1},8,["to"]),e("div",ye,[e("h3",Ce,[v(f(T),{to:{name:"product",params:{id:o.product.id},meta:{title:o.product.title}}},{default:S(()=>[U($(o.product.title),1)]),_:1},8,["to"])]),e("span",xe,$(o.product.price)+" ₽ ",1),v(N,{colors:o.product.colors},null,8,["colors"])])]))}},Fe={class:"catalog__list"},we={__name:"CatalogList",props:["products"],setup(o){return(d,a)=>(i(),_("ul",Fe,[(i(!0),_(b,null,y(o.products,l=>(i(),B(Pe,{product:l,key:l.id},null,8,["product"]))),128))]))}},Ie={class:"catalog__pagination pagination"},Ue={class:"pagination__item"},Se={symbol:"icon-arrow-left",size:"0 0 8 14"},Te={class:"pagination__item"},qe={symbol:"icon-arrow-right",size:"0 0 8 14"},Be={__name:"CatalogPagination",props:["page","count","perPage"],emits:["pagination"],setup(o,{emit:d}){const a=o,l=k(()=>a.page<a.count),n=k(()=>a.page>1);function s(r){let t;if(r==="next"){if(a.page===a.count)return;t=a.page+1}else if(r==="prev"){if(a.page===1)return;t=a.page-1}else t=r;d("pagination",t)}return(r,t)=>{const u=M("svg");return i(),_("ul",Ie,[e("li",Ue,[e("a",{class:F(["pagination__link pagination__link--arrow",f(n)?"":"pagination__link--disabled"]),"aria-label":"Предыдущая страница",onClick:t[0]||(t[0]=C(p=>s("prev"),["prevent"]))},[V((i(),_("svg",Se,null,512)),[[u]])],2)]),(i(!0),_(b,null,y(o.count,p=>(i(),_("li",{class:"pagination__item",key:p},[e("a",{class:F(["pagination__link",{"pagination__link--current":p===o.page}])},$(p),3)]))),128)),e("li",Te,[e("a",{class:F(["pagination__link pagination__link--arrow",f(l)?"":"pagination__link--disabled"]),href:"#","aria-label":"Следующая страница",onClick:t[1]||(t[1]=C(p=>s("next"),["prevent"]))},[V((i(),_("svg",qe,null,512)),[[u]])],2)])])}}},Re={key:1,class:"content container"},Le={class:"content__top"},Me={class:"content__row"},ze=e("h1",{class:"content__title"},"Каталог",-1),De={class:"content__info"},Ee={class:"content__catalog"},Ne={class:"catalog"},Ge={__name:"CatalogView",setup(o){const d=g(!0),a=g({}),l=g(12),n=z({page:1,pages:1,total:0}),s=D();E(()=>({params:s.params,query:s.query}),r),r();function r(){s.params.limit&&s.params.page&&(l.value=parseInt(s.params.limit),n.page=parseInt(s.params.page)),x.getProducts({page:n.page,limit:l.value},s.query).then(u=>{console.log(u),d.value=!0,a.value=u.items,Object.assign(n,u.pagination),d.value=!1})}const t=k(()=>{const u=n.total%100;let p="";return u>=10&&u<=20?p="товаров":u%10===1?p="товар":u%10>1&&u%10<5?p="товара":p="товаров",`${u} ${p}`});return(u,p)=>(i(),_(b,null,[d.value?(i(),B(j,{key:0})):w("",!0),d.value?w("",!0):(i(),_("main",Re,[e("div",Le,[e("div",Me,[ze,e("span",De,$(f(t)),1)])]),e("div",Ee,[v(ke),e("section",Ne,[v(we,{products:a.value},null,8,["products"]),v(Be,{page:n.page,count:n.pages,perPage:l.value,onPagination:p[0]||(p[0]=h=>u.$router.push({name:"products:limit",params:{limit:l.value,page:h}}))},null,8,["page","count","perPage"])])])]))],64))}};export{Ge as default};
