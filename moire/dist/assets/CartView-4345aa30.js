import{m as w,r as h,o as a,a as l,j as z,p as T,b as t,t as _,f as m,E as V,u as b,w as C,S as B,G as I,x as K,c as O,F as R,d as j,k as S,l as x,y as D}from"./index-ca4a827e.js";import{t as E}from"./sku-generator-acc5bf01.js";import{t as L}from"./color-dictionary-be2850f0.js";import{n as P}from"./no-image-7601bee4.js";import{_ as q}from"./BreadcrumbTrail-471eeca1.js";const F={class:"cart__item product"},M=["src","alt"],A={class:"product__content"},G={class:"product__info-wrap"},Q={class:"product__title"},H={class:"product__info product__info--color"},J={class:"product__size"},W={class:"product__code"},X={class:"product__counter form__counter"},Y={key:0,size:"16 16",symbol:"icon-delete"},Z={key:1,size:"12 12",symbol:"icon-minus"},tt=["value"],et={size:"12 12",symbol:"icon-plus"},st={class:"product__price"},ot={__name:"CartItem",props:["item"],emits:["update:cart","confirm:delete"],setup(r,{emit:o}){const n=r,u=300,k=w(),p=h(n.item.product),i=h(n.item.quantity),c=h(E({id:p.value.id,color:n.item.color.color.id,size:n.item.size.id}));let s;function v(){i.value++,$()}function y(){if(i.value>1)i.value--;else{$(!0);return}$()}function $(d=!1){clearTimeout(s),s=setTimeout(()=>{const e=k.getUser();d?B.deleteBasketProduct(n.item.id,e==null?void 0:e.accessKey).then(f=>{o("update:cart",f)}):B.changeBasketQuantity(n.item.id,i.value,e==null?void 0:e.accessKey).then(f=>{o("update:cart",f)})},u)}function U(d){var e;return d?(e=d[0])==null?void 0:e.file.url:P}return(d,e)=>{const f=I("RouterLink"),g=K("svg");return a(),l("li",F,[z(f,{class:"product__pic",to:{name:"product",params:{id:r.item.product.id}}},{default:T(()=>[t("img",{src:U(r.item.color.gallery),width:"120",height:"120",alt:r.item.title},null,8,M)]),_:1},8,["to"]),t("div",A,[t("div",G,[t("h3",Q,_(p.value.title),1),t("p",H,[m(" Цвет: "),t("span",null,[t("i",{style:V(`background-color: ${r.item.color.color.code}`)},null,4),m(" "+_(b(L)(r.item.color.color.title)),1)])]),t("p",J,[m(" Размер: "),t("span",null,_(r.item.size.title),1)]),t("span",W," Артикул: "+_(c.value),1)]),t("div",X,[t("button",{type:"button","aria-label":"Убрать один товар",onClick:e[0]||(e[0]=N=>y())},[i.value===1?C((a(),l("svg",Y,null,512)),[[g]]):C((a(),l("svg",Z,null,512)),[[g]])]),t("input",{type:"text",value:i.value,name:"count"},null,8,tt),t("button",{type:"button","aria-label":"Добавить один товар",onClick:e[1]||(e[1]=N=>v())},[C((a(),l("svg",et,null,512)),[[g]])])])]),t("div",st,_(d.$format.currRUB(p.value.price*i.value)),1)])}}},nt={class:"content container"},ct={class:"content__top"},it={class:"cart"},at={key:0,class:"cart__form form",action:"#",method:"POST"},rt={class:"cart__field"},lt={class:"cart__list"},ut={class:"cart__block"},dt=t("p",{class:"cart__desc"},"Мы посчитаем стоимость доставки на следующем этапе",-1),_t={class:"cart__price"},mt={key:1},pt=t("h2",null,"Ой, пусто!",-1),vt=t("p",null,[m(" Ваша корзина пуста, откройте каталог "),t("br"),m("и выбирайте лучшие товары с бесплатной доставкой ")],-1),ft=t("br",null,null,-1),gt={__name:"CartView",setup(r){const o=w(),n=h(!1),u=o.getUser();u!=null&&u.accessKey&&(n.value=!0,B.getBasket(u.accessKey).then(c=>{Object.assign(o.cart,c),o.setUser(o.cart.user),n.value=!1}));const k=O(()=>o.cart.items.reduce((c,s)=>c+=s.price*s.quantity,0)),p=h([{title:"Каталог",route:{name:"main"}},{title:"Корзина",route:{path:"#"}}]);function i(c){Object.assign(o.cart,c)}return(c,s)=>(a(),l("main",nt,[t("div",ct,[z(q,{links:p.value},null,8,["links"])]),t("section",it,[!n.value&&b(o).count>0?(a(),l("form",at,[t("div",rt,[t("ul",lt,[(a(!0),l(R,null,j(b(o).cart.items,v=>(a(),D(ot,{key:v.id,item:v,"onUpdate:cart":s[0]||(s[0]=y=>i(y))},null,8,["item"]))),128))])]),t("div",ut,[dt,t("p",_t,[m(" Итого: "),t("span",null,_(c.$format.currRUB(b(k))),1)]),t("button",{class:"cart__button button button--primery",type:"submit",onClick:s[1]||(s[1]=S(()=>c.$router.push({name:"checkout"}),["prevent"]))}," Оформить заказ ")])])):n.value?x("",!0):(a(),l("div",mt,[pt,vt,ft,t("button",{class:"item__button button button--primery",onClick:s[2]||(s[2]=S(v=>c.$router.push({name:"products"}),["prevent"]))}," Начать покупки ")]))])]))}};export{gt as default};
