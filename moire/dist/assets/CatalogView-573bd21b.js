import{r as f,c as y,S as C,o as c,a as m,b as r,w as k,v as ue,u as g,i as M,F as x,d as V,t as b,e as K,f as R,g as ce,h as Q,j as h,k as N,l as B,m as O,R as D,n as X,p as I,q as de,s as me,x as pe}from"./index-0e1dcb84.js";import{_ as _e,P as fe}from"./ProductColors-e4da63ef.js";import{n as ge}from"./no-image-7601bee4.js";import"./_plugin-vue_export-helper-c27b6911.js";const ve={class:"form__block"},he=r("legend",{class:"form__legend"},"Категория",-1),be={class:"form__label form__label--select"},$e=r("option",{value:"0"},"Все категории",-1),ke=["value"],ye={__name:"FilterCategory",props:["modelValue"],emits:["update:modelValue"],setup(t,{emit:e}){const n=t,s=f(),o=y({get(){return n.modelValue},set(a){e("update:modelValue",a)}});return C.getProductCategories().then(a=>s.value=a),(a,l)=>(c(),m("fieldset",ve,[he,r("label",be,[k(r("select",{class:"form__select",name:"category","onUpdate:modelValue":l[0]||(l[0]=i=>M(o)?o.value=i:null)},[$e,(c(!0),m(x,null,V(s.value,i=>(c(),m("option",{value:i.id,key:i.id},b(i.title),9,ke))),128))],512),[[ue,g(o)]])])]))}};var xe=Object.defineProperty,we=(t,e,n)=>e in t?xe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,j=(t,e,n)=>(we(t,typeof e!="symbol"?e+"":e,n),n);const P={debug:!1,masked:!1,prefix:"",suffix:"",thousands:",",decimal:".",precision:2,disableNegative:!1,disabled:!1,min:null,max:null,allowBlank:!1,minimumNumberOfCharacters:0,modelModifiers:{number:!1},shouldRound:!0,focusOnRight:!1},Y=["+","-"],ee=["decimal","thousands","prefix","suffix"];function $(t){return Math.max(0,Math.min(t,1e3))}function F(t,e){return t=t.padStart(e+1,"0"),e===0?t:`${t.slice(0,-e)}.${t.slice(-e)}`}function te(t){return t=t?t.toString():"",t.replace(/\D+/g,"")||"0"}function Ve(t,e){return t.replace(/(\d)(?=(?:\d{3})+\b)/gm,`$1${e}`)}function Ne(t,e,n){return e?t+n+e:t}function Pe(t,e){return Y.includes(t)?(console.warn(`v-money3 "${e}" property don't accept "${t}" as a value.`),!1):/\d/g.test(t)?(console.warn(`v-money3 "${e}" property don't accept "${t}" (any number) as a value.`),!1):!0}function Fe(t){for(const e of ee)if(!Pe(t[e],e))return!1;return!0}function A(t){for(const e of ee){t[e]=t[e].replace(/\d+/g,"");for(const n of Y)t[e]=t[e].replaceAll(n,"")}return t}function ne(t){const e=t.length,n=t.indexOf(".");return e-(n+1)}function L(t){return t.replace(/^(-?)0+(?!\.)(.+)/,"$1$2")}function se(t){return/^-?[\d]+$/g.test(t)}function ae(t){return/^-?[\d]+(\.[\d]+)$/g.test(t)}function z(t,e,n){return e>t.length-1?t:t.substring(0,e)+n+t.substring(e+1)}function oe(t,e){const n=e-ne(t);if(n>=0)return t;let s=t.slice(0,n);const o=t.slice(n);if(s.charAt(s.length-1)==="."&&(s=s.slice(0,-1)),parseInt(o.charAt(0),10)>=5){for(let a=s.length-1;a>=0;a-=1){const l=s.charAt(a);if(l!=="."&&l!=="-"){const i=parseInt(l,10)+1;if(i<10)return z(s,a,i);s=z(s,a,"0")}}return`1${s}`}return s}function ie(t,e){const n=()=>{t.setSelectionRange(e,e)};t===document.activeElement&&(n(),setTimeout(n,1))}function le(t){return new Event(t,{bubbles:!0,cancelable:!1})}function u({debug:t=!1},...e){t&&console.log(...e)}class S{constructor(e){j(this,"number",0n),j(this,"decimal",0),this.setNumber(e)}getNumber(){return this.number}getDecimalPrecision(){return this.decimal}setNumber(e){this.decimal=0,typeof e=="bigint"?this.number=e:typeof e=="number"?this.setupString(e.toString()):this.setupString(e)}toFixed(e=0,n=!0){let s=this.toString();const o=e-this.getDecimalPrecision();return o>0?(s.includes(".")||(s+="."),s.padEnd(s.length+o,"0")):o<0?n?oe(s,e):s.slice(0,o):s}toString(){let e=this.number.toString();if(this.decimal){let n=!1;return e.charAt(0)==="-"&&(e=e.substring(1),n=!0),e=e.padStart(e.length+this.decimal,"0"),e=`${e.slice(0,-this.decimal)}.${e.slice(-this.decimal)}`,e=L(e),(n?"-":"")+e}return e}lessThan(e){const[n,s]=this.adjustComparisonNumbers(e);return n<s}biggerThan(e){const[n,s]=this.adjustComparisonNumbers(e);return n>s}isEqual(e){const[n,s]=this.adjustComparisonNumbers(e);return n===s}setupString(e){if(e=L(e),se(e))this.number=BigInt(e);else if(ae(e))this.decimal=ne(e),this.number=BigInt(e.replace(".",""));else throw new Error(`BigNumber has received and invalid format for the constructor: ${e}`)}adjustComparisonNumbers(e){let n;e.constructor.name!=="BigNumber"?n=new S(e):n=e;const s=this.getDecimalPrecision()-n.getDecimalPrecision();let o=this.getNumber(),a=n.getNumber();return s>0?a=n.getNumber()*10n**BigInt(s):s<0&&(o=this.getNumber()*10n**BigInt(s*-1)),[o,a]}}function Ce(t,e=P,n=""){if(u(e,"utils format() - caller",n),u(e,"utils format() - input1",t),t==null)t="";else if(typeof t=="number")e.shouldRound?t=t.toFixed($(e.precision)):t=t.toFixed($(e.precision)+1).slice(0,-1);else if(e.modelModifiers&&e.modelModifiers.number&&se(t))t=Number(t).toFixed($(e.precision));else if(!e.disableNegative&&t==="-")return t;u(e,"utils format() - input2",t);const s=e.disableNegative?"":t.indexOf("-")>=0?"-":"";let o=t.replace(e.prefix,"").replace(e.suffix,"");u(e,"utils format() - filtered",o),!e.precision&&e.thousands!=="."&&ae(o)&&(o=oe(o,0),u(e,"utils format() - !opt.precision && isValidFloat()",o));const a=te(o);u(e,"utils format() - numbers",a),u(e,"utils format() - numbersToCurrency",s+F(a,e.precision));const l=new S(s+F(a,e.precision));u(e,"utils format() - bigNumber1",l.toString()),e.max&&l.biggerThan(e.max)&&l.setNumber(e.max),e.min&&l.lessThan(e.min)&&l.setNumber(e.min);const i=l.toFixed($(e.precision),e.shouldRound);if(u(e,"utils format() - bigNumber2",l.toFixed($(e.precision))),/^0(\.0+)?$/g.test(i)&&e.allowBlank)return"";let[d,p]=i.split(".");const T=p!==void 0?p.length:0;d=d.padStart(e.minimumNumberOfCharacters-T,"0"),d=Ve(d,e.thousands);const w=e.prefix+Ne(d,p,e.decimal)+e.suffix;return u(e,"utils format() - output",w),w}function W(t,e=P,n=""){if(u(e,"utils unformat() - caller",n),u(e,"utils unformat() - input",t),!e.disableNegative&&t==="-")return u(e,"utils unformat() - return netagive symbol",t),t;const s=e.disableNegative?"":t.indexOf("-")>=0?"-":"",o=t.replace(e.prefix,"").replace(e.suffix,"");u(e,"utils unformat() - filtered",o);const a=te(o);u(e,"utils unformat() - numbers",a);const l=new S(s+F(a,e.precision));u(e,"utils unformat() - bigNumber1",a.toString()),e.max&&l.biggerThan(e.max)&&l.setNumber(e.max),e.min&&l.lessThan(e.min)&&l.setNumber(e.min);let i=l.toFixed($(e.precision),e.shouldRound);return e.modelModifiers&&e.modelModifiers.number&&(i=parseFloat(i)),u(e,"utils unformat() - output",i),i}const E=(t,e,n)=>{if(u(e,"directive setValue() - caller",n),!Fe(e)){u(e,"directive setValue() - validateRestrictedOptions() return false. Stopping here...",t.value);return}let s=t.value.length-(t.selectionEnd||0);t.value=Ce(t.value,e,n),s=Math.max(s,e.suffix.length),s=t.value.length-s,s=Math.max(s,e.prefix.length),ie(t,s),t.dispatchEvent(le("change"))},Z=(t,e)=>{const n=t.currentTarget,s=t.code==="Backspace"||t.code==="Delete",o=n.value.length-(n.selectionEnd||0)===0;if(u(e,"directive onkeydown() - el.value",n.value),u(e,"directive onkeydown() - backspacePressed",s),u(e,"directive onkeydown() - isAtEndPosition",o),e.allowBlank&&s&&o&&W(n.value,e,"directive onkeydown allowBlank")===0&&(u(e,'directive onkeydown() - set el.value = ""',n.value),n.value="",n.dispatchEvent(le("change"))),u(e,"directive onkeydown() - e.key",t.key),t.key==="+"){u(e,"directive onkeydown() - unformat el.value",n.value);let a=W(n.value,e,"directive onkeydown +");typeof a=="string"&&(a=parseFloat(a)),a<0&&(n.value=String(a*-1))}},G=(t,e)=>{const n=t.currentTarget;u(e,"directive oninput()",n.value),/^[1-9]$/.test(n.value)&&(n.value=F(n.value,$(e.precision)),u(e,"directive oninput() - is 1-9",n.value)),E(n,e,"directive oninput")},H=(t,e)=>{const n=t.currentTarget;u(e,"directive onFocus()",n.value),e.focusOnRight&&ie(n,n.value.length-e.suffix.length)},J={mounted(t,e){if(!e.value)return;const n=A({...P,...e.value});if(u(n,"directive mounted() - opt",n),t.tagName.toLocaleUpperCase()!=="INPUT"){const s=t.getElementsByTagName("input");s.length!==1||(t=s[0])}t.onkeydown=s=>{Z(s,n)},t.oninput=s=>{G(s,n)},t.onfocus=s=>{H(s,n)},u(n,"directive mounted() - el.value",t.value),E(t,n,"directive mounted")},updated(t,e){if(!e.value)return;const n=A({...P,...e.value});t.onkeydown=s=>{Z(s,n)},t.oninput=s=>{G(s,n)},t.onfocus=s=>{H(s,n)},u(n,"directive updated() - el.value",t.value),u(n,"directive updated() - opt",n),E(t,n,"directive updated")},beforeUnmount(t){t.onkeydown=null,t.oninput=null,t.onfocus=null}},Se={class:"form__block"},Te=r("legend",{class:"form__legend"},"Цена",-1),Ie={class:"form__label form__label--price"},Be=["value"],Ee=r("span",{class:"form__value"},"От",-1),Me={class:"form__label form__label--price"},Re=["value"],qe=r("span",{class:"form__value"},"До",-1),Ue={__name:"FilterPrice",props:["priceFrom","priceTo"],emits:["update:priceFrom","update:priceTo"],setup(t){return(e,n)=>(c(),m("fieldset",Se,[Te,r("label",Ie,[k(r("input",{"data-maska":"000 000 00#","data-maska-tokens":"0:[0-9]:optional",reversed:"",class:"form__input",type:"text",name:"min-price",autocomplete:"off",value:t.priceFrom,onInput:n[0]||(n[0]=s=>e.$emit("update:priceFrom",s.target.value))},null,40,Be),[[g(J),{precision:0,thousands:""}]]),Ee]),r("label",Me,[k(r("input",{class:"form__input",type:"text",name:"max-price",autocomplete:"off",value:t.priceTo,onInput:n[1]||(n[1]=s=>e.$emit("update:priceTo",s.target.value))},null,40,Re),[[g(J),{precision:0,thousands:""}]]),qe])]))}},Oe={class:"form__block"},De=r("legend",{class:"form__legend"},"Материал",-1),je={class:"check-list"},Ae={class:"check-list__label"},Le=["value"],ze={class:"check-list__desc"},We={__name:"FilterMaterial",props:["modelValue"],emits:["update:modelValue"],setup(t,{emit:e}){const n=t,s=f([]),o=y({get(){return n.modelValue},set(a){e("update:modelValue",a)}});return C.getMaterials().then(a=>s.value=a),(a,l)=>(c(),m("fieldset",Oe,[De,r("ul",je,[(c(!0),m(x,null,V(s.value,i=>(c(),m("li",{key:i.id,class:"check-list__item"},[r("label",Ae,[k(r("input",{class:"check-list__check sr-only",type:"checkbox",name:"material",value:i.id,"onUpdate:modelValue":l[0]||(l[0]=d=>M(o)?o.value=d:null)},null,8,Le),[[K,g(o)]]),r("span",ze,[R(b(i.title),1),r("span",null,"("+b(i.productsCount)+")",1)])])]))),128))])]))}},Ze={class:"form__block"},Ge=r("legend",{class:"form__legend"},"Коллекция",-1),He={class:"check-list"},Je={class:"check-list__label"},Ke=["value"],Qe={class:"check-list__desc"},Xe={__name:"FilterSeasons",props:["modelValue"],emits:["update:modelValue"],setup(t,{emit:e}){const n=t,s=f([]),o=y({get(){return n.modelValue},set(a){e("update:modelValue",a)}});return C.getSeasons().then(a=>s.value=a),(a,l)=>(c(),m("fieldset",Ze,[Ge,r("ul",He,[(c(!0),m(x,null,V(s.value,i=>(c(),m("li",{key:i.id,class:"check-list__item"},[r("label",Je,[k(r("input",{class:"check-list__check sr-only",type:"checkbox",name:"collection",value:i.id,"onUpdate:modelValue":l[0]||(l[0]=d=>M(o)?o.value=d:null)},null,8,Ke),[[K,g(o)]]),r("span",Qe,[R(b(i.title)+" ",1),r("span",null,"("+b(i.productsCount)+")",1)])])]))),128))])]))}},Ye={class:"filter"},et={class:"filter__form form",action:"#",method:"get"},tt={__name:"FilterForm",setup(t){var w,q,U;const e=ce(),n=Q(),s=f(!1),o=f(0),a=f(0),l=f(0),i=f([]),d=f([]);o.value=((w=n.query)==null?void 0:w.minPrice)||0,a.value=((q=n.query)==null?void 0:q.maxPrice)||0,l.value=((U=n.query)==null?void 0:U.categoryId)||0,i.value=n.query["materialIds[]"]||[],d.value=n.query["seasonIds[]"]||[];const p=y(()=>({...o.value>0?{minPrice:o.value}:{},...a.value>0?{maxPrice:a.value}:{},...l.value>0?{categoryId:l.value}:{},...i.value.length>0?{"materialIds[]":i.value}:{},...d.value.length>0?{"seasonIds[]":d.value}:{}}));function T(){o.value=0,a.value=0,l.value=0,i.value=[],d.value=[],s.value=!1,e.replace({query:p.value})}return(re,_)=>(c(),m("aside",Ye,[r("form",et,[h(Ue,{priceFrom:o.value,"onUpdate:priceFrom":_[0]||(_[0]=v=>o.value=v),priceTo:a.value,"onUpdate:priceTo":_[1]||(_[1]=v=>a.value=v)},null,8,["priceFrom","priceTo"]),h(ye,{modelValue:l.value,"onUpdate:modelValue":_[2]||(_[2]=v=>l.value=v)},null,8,["modelValue"]),h(We,{modelValue:i.value,"onUpdate:modelValue":_[3]||(_[3]=v=>i.value=v)},null,8,["modelValue"]),h(Xe,{modelValue:d.value,"onUpdate:modelValue":_[4]||(_[4]=v=>d.value=v)},null,8,["modelValue"]),r("button",{class:"filter__submit button button--primery",type:"submit",onClick:_[5]||(_[5]=N(v=>re.$router.replace({query:g(p)}),["prevent"]))}," Применить "),Object.entries(g(p)).length>0?(c(),m("button",{key:0,class:"filter__reset button button--second",type:"button",onClick:_[6]||(_[6]=N(v=>T(),["prevent"]))}," Сбросить ")):B("",!0)])]))}},nt={class:"catalog__item"},st=["src","alt"],at={class:"catalog__item-content"},ot={class:"catalog__title"},it={class:"catalog__price"},lt={__name:"CatalogItem",props:["product"],setup(t){return(e,n)=>(c(),m("li",nt,[h(g(D),{class:"catalog__pic",to:{name:"product",params:{id:t.product.id},meta:{title:t.product.title}}},{default:O(()=>[r("img",{src:t.product.colors[0].gallery?t.product.colors[0].gallery[0].file.url:g(ge),alt:t.product.title},null,8,st)]),_:1},8,["to"]),r("div",at,[r("h3",ot,[h(g(D),{to:{name:"product",params:{id:t.product.id},meta:{title:t.product.title}}},{default:O(()=>[R(b(t.product.title),1)]),_:1},8,["to"])]),r("span",it,b(e.$format.currRUB(t.product.price)),1),h(_e,{colors:t.product.colors},null,8,["colors"])])]))}},rt={class:"catalog__list"},ut={__name:"CatalogList",props:["products"],setup(t){return(e,n)=>(c(),m("ul",rt,[(c(!0),m(x,null,V(t.products,s=>(c(),X(lt,{product:s,key:s.id},null,8,["product"]))),128))]))}},ct={class:"catalog__pagination pagination"},dt={class:"pagination__item"},mt={symbol:"icon-arrow-left",size:"0 0 8 14"},pt={class:"pagination__item"},_t={symbol:"icon-arrow-right",size:"0 0 8 14"},ft={__name:"CatalogPagination",props:["page","count","perPage"],emits:["pagination"],setup(t,{emit:e}){const n=t,s=y(()=>n.page<n.count),o=y(()=>n.page>1);function a(l){let i;if(l==="next"){if(n.page===n.count)return;i=n.page+1}else if(l==="prev"){if(n.page===1)return;i=n.page-1}else i=l;e("pagination",i)}return(l,i)=>{const d=de("svg");return c(),m("ul",ct,[r("li",dt,[r("a",{class:I(["pagination__link pagination__link--arrow",g(o)?"":"pagination__link--disabled"]),"aria-label":"Предыдущая страница",onClick:i[0]||(i[0]=N(p=>a("prev"),["prevent"]))},[k((c(),m("svg",mt,null,512)),[[d]])],2)]),(c(!0),m(x,null,V(t.count,p=>(c(),m("li",{class:"pagination__item",key:p},[r("a",{class:I(["pagination__link",{"pagination__link--current":p===t.page}])},b(p),3)]))),128)),r("li",pt,[r("a",{class:I(["pagination__link pagination__link--arrow",g(s)?"":"pagination__link--disabled"]),href:"#","aria-label":"Следующая страница",onClick:i[1]||(i[1]=N(p=>a("next"),["prevent"]))},[k((c(),m("svg",_t,null,512)),[[d]])],2)])])}}},gt={key:1,class:"content container"},vt={class:"content__top"},ht={class:"content__row"},bt=r("h1",{class:"content__title"},"Каталог",-1),$t={class:"content__info"},kt={class:"content__catalog"},yt={class:"catalog"},Pt={__name:"CatalogView",setup(t){const e=f(!0),n=f({}),s=f(12),o=me({page:1,pages:1,total:0}),a=Q();pe(()=>({params:a.params,query:a.query}),l),l();function l(){a.params.limit&&a.params.page&&(s.value=parseInt(a.params.limit),o.page=parseInt(a.params.page)),C.getProducts({page:o.page,limit:s.value},a.query).then(i=>{e.value=!0,n.value=i.items,Object.assign(o,i.pagination),e.value=!1})}return(i,d)=>(c(),m(x,null,[e.value?(c(),X(fe,{key:0})):B("",!0),e.value?B("",!0):(c(),m("main",gt,[r("div",vt,[r("div",ht,[bt,r("span",$t,b(i.$format.countItemsText(o.total)),1)])]),r("div",kt,[h(tt),r("section",yt,[h(ut,{products:n.value},null,8,["products"]),h(ft,{page:o.page,count:o.pages,perPage:s.value,onPagination:d[0]||(d[0]=p=>i.$router.push({name:"products:limit",params:{limit:s.value,page:p}}))},null,8,["page","count","perPage"])])])]))],64))}};export{Pt as default};
